# 更新说明 - 可装箱数向上取整

## 更新日期
2025-11-09

## 更新内容

### 修改：可装箱数计算规则

**原规则：** 向下取整  
**新规则：** 向上取整

### 原因

与CBM计算规则保持一致，符合行业惯例。

### 计算对比

| 单箱材积 | 计算结果 | 向下取整 | 向上取整 |
|---------|---------|---------|---------|
| 1.5 | 950÷1.5=633.33 | 633箱 | **634箱** |
| 1.8 | 950÷1.8=527.78 | 527箱 | **528箱** |
| 2.3 | 950÷2.3=413.04 | 413箱 | **414箱** |
| 4.1 | 950÷4.1=231.71 | 231箱 | **232箱** |

### 数量对比（每箱120pcs）

| 单箱材积 | 向下取整数量 | 向上取整数量 | 差异 |
|---------|------------|------------|------|
| 1.5 | 75,960pcs | **76,080pcs** | +120pcs |
| 1.8 | 63,240pcs | **63,360pcs** | +120pcs |
| 2.3 | 49,560pcs | **49,680pcs** | +120pcs |
| 4.1 | 27,720pcs | **27,840pcs** | +120pcs |

### 代码修改

**文件：** `frontend/src/views/cost/CostAdd.vue`

**修改前：**
```javascript
maxCartons = Math.floor(950 / cartonVolume) // 向下取整
```

**修改后：**
```javascript
maxCartons = Math.ceil(950 / cartonVolume) // 向上取整
```

### 影响范围

- ✅ 仅影响整柜FOB深圳的数量计算
- ✅ 不影响散货运费计算
- ✅ 不影响其他港口
- ✅ 不影响内销

### 示例

**场景：** 单箱材积1.5立方英尺，每箱120pcs

**修改前：**
```
可装箱数 = 950 ÷ 1.5 = 633.33 → 633箱（向下取整）
建议数量 = 633 × 120 = 75,960pcs
```

**修改后：**
```
可装箱数 = 950 ÷ 1.5 = 633.33 → 634箱（向上取整）
建议数量 = 634 × 120 = 76,080pcs
```

### 文档更新

已更新以下文档：
- ✅ `docs/整柜FOB深圳自动计算功能说明.md`
- ✅ `docs/更新-可装箱数向上取整.md`（本文档）

### 测试验证

建议测试以下场景：
1. 单箱材积为整数（如2.0）
2. 单箱材积为小数（如1.5、2.3）
3. 单箱材积接近整数（如4.1、4.9）

### 部署说明

1. 前端代码已修改
2. 无需后端修改
3. 无需数据库修改
4. 重新构建前端即可部署

---

**更新完成！** ✅
