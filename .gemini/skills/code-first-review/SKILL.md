---
name: code-first-review
description: "当用户提出功能需求或修改请求时触发。必须先阅读相关项目代码，再提供方案与建议，最后说明执行该操作对项目的影响。"
---

# 代码优先审查

## 触发条件
当用户提出以下类型请求时自动触发：
- 新增功能
- 修改现有功能
- 优化/重构代码
- 修复 Bug
- 任何涉及代码变更的需求

## 执行流程

### 第一步：阅读代码
1. 识别需求涉及的模块和文件
2. 使用 `view_file` 或 `view_file_outline` 阅读相关代码
3. 理解现有代码结构、依赖关系和实现方式
4. 记录关键发现（如：现有实现、潜在问题、可复用代码）

### 第二步：提供方案
1. 基于代码分析，设计至少两种可行方案（方案 A、方案 B）
2. 说明每种方案的特点、优缺点
3. 给出推荐方案及理由
4. 等待用户选择

### 第三步：说明影响
1. 列出该操作会修改的文件
2. 说明对现有功能的影响
3. 指出潜在风险或需要同步更新的地方
4. 如有必要，建议测试验证方式

## 输出格式

### 模板
```markdown
## 📖 代码分析

我已阅读以下相关文件：
- `path/to/file1.vue` - [简要说明该文件的作用]
- `path/to/file2.ts` - [简要说明该文件的作用]

**现有实现**：[描述当前代码的实现方式]

**发现的问题/可优化点**：[如有]

---

## 💡 方案建议

### 方案 A：[方案名称]
**特点**：[描述]
**优点**：[列举]
**缺点**：[列举]

### 方案 B：[方案名称]
**特点**：[描述]
**优点**：[列举]
**缺点**：[列举]

**推荐**：[推荐哪个方案及理由]

老板，请问您倾向于选择哪个方案？

---

## ⚠️ 影响评估

### 涉及文件
- [ ] `path/to/file1.vue` - [修改内容]
- [ ] `path/to/file2.ts` - [修改内容]

### 对现有功能的影响
- [影响点1]
- [影响点2]

### 风险提示
- [潜在风险，如有]

### 建议验证方式
- [如何测试验证修改是否成功]
```

## 规范要求
- **禁止**在未阅读代码前直接给出方案
- **必须**提供至少两种方案供用户选择
- **必须**说明对项目的影响
- 方案选择权在用户（"老板"）手中
