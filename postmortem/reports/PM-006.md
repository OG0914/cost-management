# PM-006: 工价系数重复乘以1.56

## 元信息
- **ID**: PM-006
- **修复Commit**: d4fc2b8
- **影响范围**: 成本计算核心逻辑
- **根因类别**: `PRECISION`

## 问题描述
工价系数在计算过程中被重复乘以 1.56，导致最终成本计算结果偏高。

## 根因分析
- **直接原因**: 后端 `costCalculator.js` 和前端 `CostAdd.vue` 都应用了工价系数
- **深层原因**: 
  1. 系数应用位置不明确（谁负责乘？）
  2. 计算流程文档缺失
  3. 前后端各自实现计算逻辑，未统一
- **涉及文件**: 
  - `backend/controllers/costController.js`
  - `backend/utils/costCalculator.js`
  - `frontend/src/views/cost/CostAdd.vue`
  - `frontend/src/views/cost/CostDetail.vue`

## 触发条件 ⚠️ 关键
```yaml
patterns:
  - type: code_pattern
    regex: "\\*\\s*1\\.56|\\*\\s*coefficient|系数.*\\*"
    description: "系数乘法操作可能在多处重复"
  - type: code_pattern
    regex: "labor.*cost.*\\*|工价.*\\*|工费.*\\*"
    description: "人工成本计算涉及系数"
  - type: scenario
    description: "任何涉及系数/比率的计算，需确认只应用一次"
  - type: keyword
    words: ["系数", "coefficient", "1.56", "工价", "labor_cost"]
```

## 修复方案
1. 系数只在后端 `costCalculator.js` 统一应用
2. 前端只显示后端计算结果，不做二次计算
3. 添加单元测试验证系数应用次数

## 预防检查清单
- [ ] 系数/比率只在一处应用（推荐后端）
- [ ] 前端禁止对后端返回的金额做系数运算
- [ ] 新增系数时，搜索全局确认无重复应用
- [ ] 计算流程需有文档说明系数应用位置

## 相关问题
- 同类: PM-005 (利润区间计算错误)
- 模式: PRECISION - 重复计算
